(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[5024],{

/***/ 376699:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);__web_req__(558104);self._fe4d99ebe0d2d259646a80d250150d47 = self._fe4d99ebe0d2d259646a80d250150d47 || {};(function(__c) {var rc=__c.rc;var Gc=__c.Gc;var vt=__c.vt;var P=__c.P;var fw=__c.fw;var Td=__c.Td;var gj=__c.gj;var B=__c.B;var Hd=__c.Hd;var D=__c.D;var O=__c.O;
var rBb=function(a){switch(a){case 4:return O("9ND0kg");case 2:return O("ibdecg");case 7:return O("446quA");case 5:return O("j1fbqg");case 1:return O("O5i4AQ");case 6:return O("C0VHsg");case 3:return O("+IXmVg");default:throw new D(a);}},sBb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},tBb=function(a){return b=>({type:"dom",render:c=>a(b,c)})},vBb=function(a){var b,c=a.yw,d=a.content;a=a.context;__c.z("formula"===(null===d||void 0===d?void 0:null===(b=d.Og)||void 0===b?void 0:
b.type));b=d.Og.value;switch(b.type){case "invalid":b=b.a7;break;case "canonical":b=b.bH;break;default:throw new D(b);}__c.z(b.startsWith("="));const e=d.$u;b={type:"dom",render:h=>h.innerText=""};let f;switch(e.type){case 6:f=b;break;case 1:case 3:case 4:case 2:case 5:f=uBb(c,a,d.Gu);break;case 0:f={type:"react",node:V5(__c.ZT,{label:rBb(e.error),children:V5(__c.mO,{width:"full",display:"flex",justifyContent:"center",children:V5(__c.mfb,{tone:"critical"})})})};break;default:throw new D(e);}if(!f)return b;
c=Hd(__c.DS,a.attrs);d=__c.zI(a.attrs.textAlign,"formula",void 0,()=>e.type);const g={textAlign:__c.fta(d,c.direction),justifyContent:__c.gta(d)};switch(f.type){case "dom":return{type:"dom",render:h=>{Object.assign(h.style,g);f.render(h)}};case "react":return{type:"react",node:V5("div",{style:g,children:f.node})};default:throw new D(f);}},uBb=function(a,b,c){var d;return null===(d=a.haa)||void 0===d?void 0:d.call(a,{context:b,value:c})},zBb=function(a){const b=a.yw,c=a.hh;a=a.H7a;b.haa=wBb;b.Iqa=
d=>vBb({...d,yw:b});b.Jqa=sBb(xBb({hh:c,qR:void 0}));b.Mqa=yBb(a);b.Nqa=sBb(W5)},ABb=function(a,b,c){const d=[a];for(;null!=a&&a!==b;)(a=c.next(a))&&d.push(a);return d},BBb=function({label:a,width:b,height:c,scale:d,highlight:e,selected:f}){return V5("div",{style:{width:b,height:c,transform:`scale(${d})`},className:"bx74uQ",children:V5(__c.jv,{className:X5({yiml1g:e,oYlhXA:f}),size:"small",alignment:"center",children:a})})},DBb=function({$c:a,highlight:b,scale:c,ov:d,Xm:e,OKa:f}){const g=Y5(()=>{const m=
null===d||void 0===d?void 0:d.get();if(null!=m&&0!==m.length)return new __c.pE(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,OkifGQ:a};return V5(__c.kv,{ho:"light",light:"light",Jq:"light",dark:"light",children:m=>V5("div",{className:X5("ze9QCQ",l,m.className),style:{width:k,height:k},children:V5("div",{style:{width:h,height:h,transform:`scale(${c})`},className:X5("N7J3UA",l),ref:null===g||void 0===g?void 0:g.Wf,children:V5(__c.nO,{className:X5("m8CFdg",l,{G6wL4w:f,W_E0wA:b}),ariaLabel:O("ruWN9A"),children:V5(CBb,
{size:"tiny"})})})})})},FBb=function(){const a=new EBb,b=new __c.GY,c=Z5(f=>{const {scale:g=1,size:h="small",OKa:k=!0}=f,l=$5(m=>a.Xm(m,h),[h]);return V5(DBb,{...f,scale:g,$c:"rtl"===f.sheet.direction,highlight:null!=f.selection&&a.kZa(f.sheet,f.selection),Xm:l,OKa:k})}),d=Z5(f=>{const {scale:g=1,size:h="small"}=f,k=$5(n=>a.Xm(n,h),[h]),l=$5(n=>null!=f.selection&&a.dGa(f.selection).has(n),[f.selection]),m=$5(n=>null!=f.selection&&a.uXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return V5(a6,
{...f,scale:g,Xm:k,nza:l,WGa:m,QO:b})}),e=Z5(f=>{const {scale:g=1,size:h="small"}=f,k=$5(n=>a.Xm(n,h),[h]),l=$5(n=>null!=f.selection&&a.fGa(f.selection).has(n),[f.selection]),m=$5(n=>null!=f.selection&&a.vXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return V5(b6,{...f,scale:g,Xm:k,XGa:m,Jza:l,QO:b})});return{mLa:c,lLa:d,nLa:e}},GBb=function(a){const b=a.uq,c=()=>null;return __c.Ut(d=>V5(c6,{...d,uq:b,Rj:c}))},JBb=function({onScroll:a}){const b=new HBb(a);return{IF:b,P$:Z5(c=>V5(IBb,{sheet:c.sheet,
IF:b,children:c.children}))}},LBb=function(a){const b=a.uq,c=a.Rd,d=a.NGa,e=({children:k})=>k,{IF:f,P$:g}=JBb({onScroll:a.onScroll});class h extends KBb{get HG(){const k=this.props.Ib.WD;switch(k){case "screen":return g;case "print":return e;default:throw new D(k);}}componentWillUnmount(){d.pQa(this.props.item,{Xb:this.props.Xb,Ib:this.props.Ib,yh:this.props.yh})}render(){d.q6a(this.props.item,{Xb:this.props.Xb,Ib:this.props.Ib,yh:this.props.yh});return V5(d6,{...this.props,scaleFactor:this.scaleFactor,
uq:b,Rd:c,HG:this.HG,NGa:d})}constructor(...k){super(...k);this.scaleFactor=e6(()=>{const l=this.props.item;var m=this.props.Ib,n=m.WD;m=m.zoom;switch(n){case "screen":return 1;case "print":n=d.MWa(l);if(!n)return 1;({width:n}=new __c.Ew(l,n.Xb,{zoom:m}));return n/l.config.width;default:throw new D(n);}})}}return{gNa:h,IF:f}},MBb=function(a,b){if(null!=b&&null!=b.Kc&&null!=b.Oc&&null!=b.Vd&&null!=b.re){var c=a.qa(b.Kc),d=a.ra(b.Oc),e=a.qa(b.Vd)+b.Vd.width-c;a=a.ra(b.re)+b.re.height-d;return __c.es({top:d,
left:c,width:e,height:a})}},OBb=function(a){const b=a.uq,c=()=>null;return d=>V5(NBb,{...d,uq:b,Rj:c})},PBb=function(a,b,c){return a<c&&c<b},TBb=function(a,b,c,d,e){if(0===c.length||0===d.length)return[];const f=QBb(a,b,c,d,e);e=RBb(a,b,c,d,e);const g=SBb(a,b,c,d),h=a.IWa(b),k=a.gWa(b),l="rtl"===b.direction;a=f.map(m=>{var n,p,q=m.X6a,r=m.Lea,t=m.EFa;const u=m.color,w=m.weight;m=m.Tb;const x=l?-1:1,y=null===(n=g.get(f6(q,t)))||void 0===n?void 0:n.Ja;n=null===(p=g.get(f6(r,t)))||void 0===p?void 0:
p.qa;if(null!=y&&null!=n){p=B(h.get(t.xa));var A=B(k.get(q.column));q=B(k.get(r.column));t="start"===t.boundary?p.start:p.end;p=A.start;r="start"===r.boundary?q.start:q.end;return{color:u,weight:w,Tb:m,p1:new __c.Fr(p+y*x,t),p2:new __c.Fr(r+n*x,t),...__c.hw((r-p)*x,m*w,y)}}}).filter(__c.tb);return[...e.map(m=>{var n,p,q=m.Bta,r=m.b7a,t=m.Oea;const u=m.color,w=m.weight;m=m.Tb;const x=null===(n=g.get(f6(q,r)))||void 0===n?void 0:n.Fa;n=null===(p=g.get(f6(q,t)))||void 0===p?void 0:p.ra;if(null!=x&&null!=
n){p=B(k.get(q.column));var y=B(h.get(r.xa));r=B(h.get(t.xa));q="start"===q.boundary?p.start:p.end;p=y.start;t="start"===t.boundary?r.start:r.end;return{color:u,weight:w,Tb:m,p1:new __c.Fr(q,p+x),p2:new __c.Fr(q,t+n),...__c.hw(t-p,m*w,x)}}}).filter(__c.tb),...a]},UBb=function(a){const b=[];a=a.filter(c=>0!==c.weight&&null!=c.color);a=__c.qd(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-d);for(const [c,d]of a){a=__c.qd(d,e=>`${e.Si}_${e.Ti}`);for(const [,e]of a){const {Ti:f,Si:g}=e[0];
a=__c.qd(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Si:g,Ti:f})}}return b},WBb=function(a,b,c,d){var e=VBb;b=b.flatMap(f=>a.rows.last()===f?[{xa:f,boundary:"start"},{xa:f,boundary:"end"}]:[{xa:f,boundary:"start"}]);c=c.flatMap(f=>a.cols.last()===f?[{column:f,boundary:"start"},{column:f,boundary:"end"}]:[{column:f,boundary:"start"}]);d=TBb(e,a,b,c,e.KQa(d));return UBb(d)},QBb=function(a,b,c,d,e){const f=[];for(const l of c)for(const m of d){c=l.xa;var g=m.column,h=gj(b.cells,
g,c);if(!h||h.span.Oc===c)if(c=g6(a.jK,b,g,c,e),c="start"===l.boundary?null===c||void 0===c?void 0:c.ra:null===c||void 0===c?void 0:c.Fa){h=f[f.length-1];g=(g=b.cols.next(g))?{column:g,boundary:"start"}:{column:B(b.cols.last()),boundary:"end"};var k;if(k=h)k=h.Lea,k=k.column===m.column&&k.boundary===m.boundary;k&&(k=h.EFa,k=k.xa===l.xa&&k.boundary===l.boundary);k&&h.color===c.color&&h.weight===c.weight&&h.Tb===c.Tb&&0===h.Tb?h.Lea=g:f.push({EFa:l,X6a:m,Lea:g,color:c.color,weight:c.weight,Tb:c.Tb})}}return f},
RBb=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of c){var g=m.xa;d=l.column;var h=gj(b.cells,d,g);if(!h||h.span.Kc===d)if(d=g6(a.jK,b,d,g,e),d="start"===l.boundary?null===d||void 0===d?void 0:d.qa:null===d||void 0===d?void 0:d.Ja){h=f[f.length-1];g=(g=b.rows.next(g))?{xa:g,boundary:"start"}:{xa:B(b.rows.last()),boundary:"end"};var k;if(k=h)k=h.Bta,k=k.column===l.column&&k.boundary===l.boundary;k&&(k=h.Oea,k=k.xa===m.xa&&k.boundary===m.boundary);k&&h.color===d.color&&h.weight===d.weight&&
h.Tb===d.Tb&&0===h.Tb?h.Oea=g:f.push({Bta:l,b7a:m,Oea:g,color:d.color,weight:d.weight,Tb:d.Tb})}}return f},SBb=function(a,b,c,d){const e=(p,q)=>{var r=a.jK.uRa(b);const t=r.get(p)||0;r=r.get(q)||0;return t<=r?p:q},f=new Map;if(0===c.length||0===d.length)return f;var g=[],h=b.cols.Bc(d[0].column);h&&g.push({column:h,boundary:"start"});g.push(...d);(d=b.cols.next(d[d.length-1].column))&&g.push({column:d,boundary:"start"});d=[];(h=b.rows.Bc(c[0].xa))&&d.push({xa:h,boundary:"start"});d.push(...c);(c=
b.rows.next(c[c.length-1].xa))&&d.push({xa:c,boundary:"start"});for(const p of g){c=(g="start"===p.boundary?p.column:void 0)?b.cols.Bc(g):b.cols.last();for(const q of d){var k="start"===q.boundary?q.xa:void 0;h=k?b.rows.Bc(k):b.rows.last();var l=g6(a.jK,b,g,k),m=g6(a.jK,b,g,h);k=g6(a.jK,b,c,k);var n=g6(a.jK,b,c,h);h="end"===p.boundary?null===k||void 0===k?void 0:k.Ja:null===l||void 0===l?void 0:l.qa;l="end"===q.boundary?null===m||void 0===m?void 0:m.Fa:null===l||void 0===l?void 0:l.ra;m="end"===p.boundary?
null===n||void 0===n?void 0:n.Ja:null===m||void 0===m?void 0:m.qa;k="end"===q.boundary?null===n||void 0===n?void 0:n.Fa:null===k||void 0===k?void 0:k.ra;n=__c.ew({ra:m,Fa:h,qa:k,Ja:l},e);let r;switch(n){case "blockStart":r=m;break;case "blockEnd":r=h;break;case "inlineStart":r=k;break;case "inlineEnd":r=l;break;default:r=void 0}const {height:t,width:u}=1===(null===r||void 0===r?void 0:r.Tb)?{height:r.weight,width:r.weight}:{height:Math.max((null===k||void 0===k?void 0:k.weight)||0,(null===l||void 0===
l?void 0:l.weight)||0),width:Math.max((null===m||void 0===m?void 0:m.weight)||0,(null===h||void 0===h?void 0:h.weight)||0)};f.set(f6(p,q),__c.bw(n,t/2,u/2))}}return f},g6=function(a,b,c,d,e){if(c&&d)return a.m5a(b,e).get(`${c.id}:${d.id}`)},XBb=function(a,b,c){var d,e=b?a.layout.attrs.get(Td({z_:void 0,I_:void 0,D_:void 0}),b.span.Oc,b.span.Kc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Kc.id}:${b.span.Oc.id}`))||void 0===d?void 0:d.Fa)||!1;d={color:a.bi.color,weight:a.bi.weight,
Tb:fw(a.bi.vd)};c=h6(e.z_);var f=i6(e.I_);e=j6(e.D_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,tB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Tb:e?fw(e):d.Tb},tB:!1,hidden:b}}},YBb=function(a,b,c){var d,e=b?a.layout.attrs.get(Td({A_:void 0,J_:void 0,F_:void 0}),b.span.Oc,b.span.Kc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Kc.id}:${b.span.Oc.id}`))||void 0===d?void 0:d.ra)||!1;d={color:a.bi.color,
weight:a.bi.weight,Tb:fw(a.bi.vd)};c=h6(e.A_);var f=i6(e.J_);e=j6(e.F_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,tB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Tb:e?fw(e):d.Tb},tB:!1,hidden:b}}},k6=function(a,b,c,d){if(!a.hidden&&!c.hidden){var e=a.tB?c.tB?void 0:c:a;return __c.dw(a.borderStyle,c.borderStyle,b,d,null===e||void 0===e?void 0:e.borderStyle)}},ZBb=function(a,b,c){var d,e=b?a.layout.attrs.get(Td({B_:void 0,K_:void 0,
G_:void 0}),b.span.Oc,b.span.Kc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Kc.id}:${b.span.Oc.id}`))||void 0===d?void 0:d.Ja)||!1;d={color:a.bi.color,weight:a.bi.weight,Tb:fw(a.bi.vd)};c=h6(e.B_);var f=i6(e.K_);e=j6(e.G_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,tB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Tb:e?fw(e):d.Tb},tB:!1,hidden:b}}},$Bb=function(a,b,c){var d,e=b?a.layout.attrs.get(Td({C_:void 0,
L_:void 0,H_:void 0}),b.span.Oc,b.span.Kc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Kc.id}:${b.span.Oc.id}`))||void 0===d?void 0:d.qa)||!1;d={color:a.bi.color,weight:a.bi.weight,Tb:fw(a.bi.vd)};c=h6(e.C_);var f=i6(e.L_);e=j6(e.H_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,tB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Tb:e?fw(e):d.Tb},tB:!1,hidden:b}}},aCb=function(a,b,c){var d=b.column,
e=b.xa;if(b=gj(a.cells,d,e)){var f=d===b.span.Kc,g=d===b.span.Vd,h=e===b.span.Oc,k=e===b.span.re;if(f||g||h||k){var l=a.rows.Bc(e),m=l?gj(a.cells,d,l):void 0,n=(l=a.rows.next(e))?gj(a.cells,d,l):void 0,p=(l=a.cols.Bc(d))?gj(a.cells,l,e):void 0;l=(l=a.cols.next(d))?gj(a.cells,l,e):void 0;var q=a.rows.first(),r=e===q;q=a.rows.last();q=e===q;e=a.cols.first();e=d===e;var t=a.cols.last();d=d===t;var u=XBb(a,m,c);t=YBb(a,b,c);var w;h=h?!r&&u&&t?k6(u,[...(null!==(w=null===m||void 0===m?void 0:m.span.columns)&&
void 0!==w?w:[])].map(C=>a.Kq(C)),t,[...b.span.columns].map(C=>a.Kq(C))):null===t||void 0===t?void 0:t.borderStyle:void 0;w=XBb(a,b,c);m=YBb(a,n,c);var x;k=k?!q&&w&&m?k6(w,[...b.span.columns].map(C=>a.Kq(C)),m,[...(null!==(x=null===n||void 0===n?void 0:n.span.columns)&&void 0!==x?x:[])].map(C=>a.Kq(C))):null===w||void 0===w?void 0:w.borderStyle:void 0;w=ZBb(a,p,c);x=$Bb(a,b,c);var y;f=f?!e&&w&&x?k6(w,[...(null!==(y=null===p||void 0===p?void 0:p.span.rows)&&void 0!==y?y:[])].map(C=>a.Jr(C)),x,[...b.span.rows].map(C=>
a.Jr(C))):null===x||void 0===x?void 0:x.borderStyle:void 0;y=ZBb(a,b,c);c=$Bb(a,l,c);var A;c=g?!d&&y&&c?k6(y,[...b.span.rows].map(C=>a.Jr(C)),c,[...(null!==(A=null===l||void 0===l?void 0:l.span.rows)&&void 0!==A?A:[])].map(C=>a.Jr(C))):null===y||void 0===y?void 0:y.borderStyle:void 0;return{ra:h,Fa:k,qa:f,Ja:c}}}},h6=function(a){return null==a||"inherit"===a?void 0:a},i6=function(a){return null==a||"inherit"===a?void 0:Number(a.split("px")[0])},j6=function(a){return null==a||"inherit"===a?void 0:
a.split(" ").map(b=>{b=Number(b);return 0<b?b:void 0}).filter(__c.tb)},cCb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},c={ata:b,DD:b,Ca:{},wS:{}},d=l6(()=>({style:a.gY.style||c,$U:a.$U}),({style:f,$U:g})=>{var h;Object.assign(a.pca.style,f.ata);Object.assign(a.YL.style,f.DD);Object.assign(a.ED.style,f.Ca);Object.assign(a.FA.style,f.wS);({textDecoration:f}=(null===(h=a.gY.style)||void 0===h?void 0:h.Ca)||{});a.ED.classList.toggle("OQx3PQ","underline"===f);a.ED.classList.toggle("_99ezUA",
"line-through"===f);a.ED.classList.toggle("kppAqQ","underline line-through"===f);a.ED.style.display=g?"none":"unset"},{fireImmediately:!0,equals:m6.structural}),e=l6(()=>a.$U?void 0:a.renderer,f=>{a.R0&&"react"!==(null===f||void 0===f?void 0:f.type)?(a.R0=void 0,a.IW.remove()):a.FA.innerHTML="";switch(null===f||void 0===f?void 0:f.type){case "react":a.R0=bCb(f.node,a.IW);a.FA.appendChild(a.IW);break;case "dom":f.render(a.FA);break;case void 0:break;default:throw new D(f);}a.$V()},{fireImmediately:!0});
return()=>{d();e()}},eCb=function(a){const b=a.zw,c=a.CG,d=new dCb(a.GX);return e=>V5(n6,{...e,CG:c,zw:b,Xga:d})},fCb=class{equals(a){return this.type===a.type&&this.sheet===a.sheet&&this.container.equals(a.container)}constructor(a,b){this.container=a;this.sheet=b;this.type="sheet-item"}},gCb=class{get sheet(){return this.container.sheet}equals(a){return this.type===a.type&&this.xa===a.xa&&this.column===a.column&&this.container.equals(a.container)}constructor(a,b,c){this.container=a;this.column=b;
this.xa=c;this.type="sheet-item-cell";this.content=B(gj(a.sheet.config.cells,b,c)).content}},hCb=class{get items(){return this.text.items}equals(a){return this.type===a.type&&this.text===a.text&&this.container.equals(a.container)}constructor(a,b){P(this,{items:__c.S});this.container=a;this.text=b;this.type="sheet-item-cell-richtext"}},xBb=({hh:a,qR:b})=>c=>(0,__c.N)(__c.abb,{...c,hh:a,qR:b}),o6=__webpack_require__(443763),V5=o6.jsx,p6=o6.jsxs,q6=o6.Fragment;var Z5=__webpack_require__(736241).Pi;var r6=__webpack_require__(875604),s6=r6.Component,KBb=r6.PureComponent,Y5=r6.useMemo,iCb=r6.useState,$5=r6.useCallback,jCb=r6.createRef;var t6=__webpack_require__(42782),e6=t6.Fl,m6=t6.p6,u6=t6.LO,v6=t6.aD,w6=t6.EH,l6=t6.U5;var x6=__webpack_require__(240236).gn;var kCb=__webpack_require__,lCb=kCb(993864),X5=kCb.n_x(lCb)();var mCb=__webpack_require__(358579).Z;var y6=__webpack_require__(649799),z6=y6.Om,A6=y6.YN,nCb=y6.kq;var bCb=__webpack_require__(204358).createPortal;var oCb=Z5(a=>{var b,c,d="rtl"===a.sheet.direction;d={H2wykw:!d,UweldA:d};const [e]=iCb(()=>vt()),f={get:$5(()=>{var g;const h=null===e||void 0===e?void 0:null===(g=e.current)||void 0===g?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:null!==(k=null===h||void 0===h?void 0:h.width)&&void 0!==k?k:0,height:null!==(l=null===h||void 0===h?void 0:h.height)&&void 0!==l?l:0};return __c.es(g)},[e])};return p6("div",{className:X5("nMvVqA",d),children:[p6("div",{ref:mCb(a.Td,e),className:"_0YOFPg",
children:[V5(a.uq,{...a,viewport:f}),V5("div",{className:X5("Gdl7fQ",d),children:null===(c=a.oqa)||void 0===c?void 0:null===(b=c.get())||void 0===b?void 0:b.map((g,h)=>V5(g,{},h))})]}),"visible"===a.wmb&&p6(q6,{children:[V5("div",{className:X5("_32sKQw",d),children:V5(a.dNa,{...a})}),V5("div",{className:X5("xdIsTQ",d),children:V5(a.hNa,{...a})}),V5("div",{className:X5("rsTRSA",d),children:V5(a.fNa,{...a})})]})]})}),pCb=Z5(a=>{a=a.content;__c.v("text2"===a.type||"text3"===a.type);switch(a.type){case "text2":return V5(q6,
{children:a.value.aa});case "text3":return V5(q6,{children:__c.aq.ya(a.value).cells.aa()});default:throw new D(a);}});var wBb=tBb((a,b)=>{const c=a.value;({Qi:a}=Hd(__c.Sd,a.context.attrs));const d=document.createElement("div");"wrap"===a&&(d.className="dt4Dlg",d.style.overflowWrap="break-word");d.innerText=c;b.appendChild(d)});var yBb=a=>tBb((b,c)=>{const d=b.content;b=b.context;if(d.value.isEmpty)for(;c.lastChild;)c.lastChild.remove();else({Qi:b}=Hd(__c.Sd,b.attrs)),"wrap"===b&&(c=c.appendChild(document.createElement("div")),c.className="dt4Dlg"),a.render({container:c,text:d.value,Ha:void 0,writingMode:1,zd:"start",zf:qCb(d,b)})}),qCb=z6((a,b)=>{if("wrap"===b)return[];a=a.value.aa.split("\n").map(c=>c.length+1);a.pop();return a},{equals:m6.structural});var W5=class a extends s6{static A(b){P(b,{Qi:e6})}get Qi(){return Hd(__c.Sd,this.props.context.attrs).Qi}render(){var b=this.props.content;const c=this.props.context;if(b.value.isEmpty)return null;b=V5(this.props.Rj,{content:b,xa:c.xa,col:c.col,Qi:this.Qi},this.key++);return"wrap"===this.Qi?V5("div",{className:"dt4Dlg",children:b}):V5(q6,{children:b})}constructor(...b){super(...b);a.A(this);this.key=0}};W5=x6([Gc],W5);var rCb=4*__c.Zu,sCb=3*__c.Zu;var EBb=class{Xm(a,b){return"large"===b?rCb*a:sCb*a}constructor(){this.kZa=z6((a,b)=>{var c,d;b=b.get();return null!=b&&a.layout.rows.count()===((null===(c=b.rows)||void 0===c?void 0:c.size)||0)&&a.layout.cols.count()===((null===(d=b.columns)||void 0===d?void 0:d.size)||0)});this.dGa=nCb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.columns)||[])},{equals:__c.Jh});this.fGa=nCb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.rows)||[])},{equals:__c.Jh});this.uXa=
z6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.dGa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of ABb(c?c.span.Kc:e.column,c?c.span.Vd:e.column,a.layout.cols))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Jh});this.vXa=z6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.fGa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of ABb(c?c.span.Oc:e.xa,c?c.span.re:
e.xa,a.layout.rows))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Jh})}};var a6=class a extends s6{static A(b){P(b,{$c:e6,Do:e6,rna:e6})}get $c(){return"rtl"===this.props.sheet.direction}get Do(){var b;const c=null===(b=this.props.ov)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.pE(c)}get rna(){var b,c,d;return null===(c=(d=this.props).pWa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return V5(__c.kv,{ho:"light",light:"light",Jq:"light",dark:"light",children:this.GQa})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
v6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"column",f)});this.onMouseLeave=v6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.Q4a=()=>{const {sheet:c,WGa:d,nza:e,Xm:f,scale:g=1}=this.props;let h=-1;return V5("div",{style:void 0,className:X5("Vt2_4w",{jNbTIg:!this.$c,gtA7Dw:this.$c},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.cols.map(k=>{h++;return V5(tCb,{col:k,label:__c.mY(h),
Tma:d,vr:e,Xm:f,scale:g},k.id)})})};this.GQa=c=>{var d;const e={jNbTIg:!this.$c,gtA7Dw:this.$c};return p6("div",{ref:null===(d=this.Do)||void 0===d?void 0:d.Wf,className:X5("xhBZaw",e,c.className),children:[void 0,this.Q4a()]})}}};a6=x6([Gc],a6);
var b6=class a extends s6{static A(b){P(b,{$c:e6,Do:e6,rna:e6})}get $c(){return"rtl"===this.props.sheet.direction}get Do(){var b;const c=null===(b=this.props.ov)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.pE(c)}get rna(){var b,c,d;return null===(c=(d=this.props).pWa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return V5(__c.kv,{ho:"light",light:"light",Jq:"light",dark:"light",children:this.y5a})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
v6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"row",f)});this.onMouseLeave=v6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.Y4a=()=>{const {sheet:c,XGa:d,Jza:e,Xm:f,scale:g=1}=this.props;let h=-1;return V5("div",{style:void 0,className:X5("_93roJg",{jNbTIg:!this.$c,gtA7Dw:this.$c},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.rows.map(k=>{h++;return V5(uCb,{xa:k,label:`${h+
1}`,Tma:d,vr:e,Xm:f,scale:g},k.id)})})};this.y5a=c=>{var d;const e={jNbTIg:!this.$c,gtA7Dw:this.$c};return p6("div",{ref:null===(d=this.Do)||void 0===d?void 0:d.Wf,className:X5("An9VeA",e,c.className),children:[void 0,this.Y4a()]})}}};b6=x6([Gc],b6);
var tCb=Z5(a=>{const {label:b,col:c,Tma:d,vr:e,Xm:f,scale:g=1}=a;a=f(g);const h=A6(()=>d(c)),k=A6(()=>e(c));return V5("div",{className:X5("_83Rssw","d2uLIA",{YbLr8g:h,sTqdww:k}),style:{width:c.width*g,height:a},children:V5(BBb,{label:b,width:c.width,height:f(1),scale:g,highlight:h,selected:k})})}),uCb=Z5(a=>{const {label:b,xa:c,Tma:d,vr:e,Xm:f,scale:g=1}=a;a=f(g);const h=A6(()=>d(c)),k=A6(()=>e(c));return V5("div",{className:X5("_83Rssw","JhBzyw",{YbLr8g:h,sTqdww:k}),style:{width:a,height:c.height*
g},children:V5(BBb,{label:b,width:f(1),height:c.height,scale:g,highlight:h,selected:k})})});var vCb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var wCb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var CBb=__c.ST({Bm:vCb,medium:wCb});var c6=class a extends s6{static A(b){P(b,{ad:e6.struct})}constructor(...b){super(...b);a.A(this)}render(){return V5(this.props.uq,{sheet:this.props.element.config,ov:this.props.ov,jy:this.props.jy,wy:this.props.wy,scaleFactor:this.props.scaleFactor,ad:this.ad,Rj:this.props.Rj,IG:void 0,oR:void 0})}get ad(){const b=this.props.Hd,c=this.props.element.altText;return c?c.Kd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}};c6=x6([Gc],c6);var xCb=class{constructor(){this.b8=new WeakMap;this.MWa=a=>this.b8.get(a);this.q6a=(a,b)=>{this.b8.set(a,b)};this.pQa=(a,b)=>{const c=this.b8.get(a);c&&c.Ib===b.Ib&&c.Xb===b.Xb&&c.yh===b.yh&&this.b8.delete(a)}}};var zCb=Z5(a=>{const b=a.Ib,c=a.item,d=a.yh,e=a.Xb,f=a.Rd,g=a.col,h=a.xa,k=a.content,l=a.Qi;a=a.TO;__c.v("text3"===k.type);__c.VI(a,__c.aq.ya(k.value),(p,q)=>__c.aq.domain.Kb(p,q));[a]=iCb(()=>new yCb(c,e,e6(()=>b.zoom)));const m=Y5(()=>new fCb(d,c),[d,c]),n=Y5(()=>{var p=new gCb(m,g,h);return new hCb(p,k.value)},[m,g,h,k.value]);return V5(f,{Ib:b,gg:n,text:k.value,Xb:a,zf:"wrap"===l?"pre-wrap":"nowrap"})}),yCb=class extends __c.xT{static A(a){P(a,{width:u6.ref,fZ:e6})}get zA(){return this.a8.zA}get fZ(){const a=
(this.Bha.width-this.a8.width)/2;return{left:-a,right:this.a8.width+a}}constructor(a,b,c){super();yCb.A(this);this.sheet=a;this.a8=b;this.zoom=c;this.width=0;this.marginWidth=void 0;this.Bha=new __c.Ew(this.sheet,this.a8,{zoom:this.zoom.get()})}};var B6=parseInt("4px",10)||4,ACb=Z5(({sheet:a,scale:b,range:c,Xs:d,Ys:e})=>{if(null!=c&&(d||e)){if(d&&e)return d=a.ra(c.re)+c.re.height,a=a.qa(c.Vd)+c.Vd.width,V5("div",{style:{top:d*b,width:a*b,height:B6*b},className:X5("aX8dhQ","VGcLng")});if(d)return c=a.qa(c.Vd)+c.Vd.width,V5("div",{style:{left:c*b,width:B6*b,height:a.height*b},className:X5("aX8dhQ","gl1RPg")});if(e)return c=a.ra(c.re)+c.re.height,V5("div",{style:{top:c*b,width:a.width*b,height:B6*b},className:X5("aX8dhQ","VGcLng")})}});var IBb=Z5(({sheet:a,children:b,IF:c})=>{const d=$5(f=>{c.Ema(a,f)},[c,a]),e=$5(f=>{null!=f?c.KF.set(a,f):c.KF.delete(a)},[c,a]);return V5(__c.Aab,{direction:"rtl"===a.config.direction?"rtl":"ltr",onScroll:d,Tt:e,children:b})}),HBb=class{Ema(a,b){this.onScroll&&this.onScroll(a);this.qX.set(a,b)}constructor(a){this.onScroll=a;this.KF=new WeakMap;this.qX=u6.map(new Map,{deep:!1});this.scrollTo=v6((b,c)=>{b=this.KF.get(b);null===b||void 0===b?void 0:b.scrollTo({left:Math.floor(c)})})}};var d6=class a extends s6{static A(b){P(b,{ad:e6.struct})}render(){const b=this.props.item;return V5("div",{ref:this.props.measureRef,className:"E8r86A",style:{width:Math.min(this.props.Xb.width,b.G)},children:V5(this.props.HG,{sheet:b,children:V5("div",{ref:this.props.gYa,className:"cXTiJA",style:{width:b.G,height:b.W},children:V5(this.props.uq,{sheet:b.config,ov:this.props.ov,scaleFactor:this.props.scaleFactor,jy:this.props.jy,wy:this.props.wy,ad:this.ad,Rj:this.Rj,IG:this.IG,oR:void 0})})})})}get ad(){const b=
this.props.Hd,c=this.props.item.altText;return c?c.Kd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}constructor(...b){super(...b);a.A(this);this.Rj=Z5(c=>V5("div",{className:"wKvivQ",children:V5(zCb,{...this.props,...c,Rd:this.props.Rd})}));this.IG=({sheet:c,range:d,Xs:e,Ys:f})=>V5(ACb,{sheet:c,scale:1,range:d,Xs:e,Ys:f})}};d6=x6([Gc],d6);var BCb=Z5(({page:a,range:b,Ypa:c})=>{if(null!=c){var d=MBb(a.sheet,b);return V5("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>null==d?V5(c,{element:e},f):__c.cs(__c.es(e)).Ko(d)&&V5(c,{element:e},f))})}});var CCb=new __c.GY,C6=a=>rCb*a,D6=()=>!1,NBb=Z5(({page:a,ov:b,jy:c,wy:d,Y2:e,scaleFactor:f,viewport:g,K6a:h,uq:k,Rj:l,Ypa:m,ccb:n,bcb:p})=>{var q="rtl"===a.sheet.direction,r;const t=null!==(r=null===f||void 0===f?void 0:f.get())&&void 0!==r?r:1;r=Y5(()=>({range:w})=>p6(q6,{children:[m&&V5(BCb,{page:a,Ypa:m,range:w}),p&&V5(p,{})]}),[a,m,p]);const u=Y5(()=>Z5(({sheet:w,range:x,Xs:y,Ys:A})=>{if(null!=x){var C,G=null!==(C=null===f||void 0===f?void 0:f.get())&&void 0!==C?C:1;return p6(q6,{children:[n&&
V5(n,{range:x}),V5(ACb,{sheet:w,scale:G,range:x,Xs:y,Ys:A})]})}}),[n,f]);b=V5(k,{sheet:a.sheet,ov:b,jy:c,wy:d,Y2:e,scaleFactor:f,viewport:g,Rj:l,IG:u,oR:r});q=p6("div",{className:"OsKKIQ",children:[V5("div",{className:"VDFv_A",children:b}),V5("div",{className:"_688KWg",children:V5(DBb,{$c:q,highlight:!1,Xm:C6,scale:t})}),V5("div",{className:"m0cT1w",children:V5(a6,{sheet:a.sheet,scale:t,Xm:C6,nza:D6,WGa:D6,QO:CCb})}),V5("div",{className:"zm537g",children:V5(b6,{sheet:a.sheet,scale:t,Xm:C6,Jza:D6,
XGa:D6,QO:CCb})})]});return h?q:b});var dCb=class{constructor(a){this.GX=a;this.cQa=__c.kW;this.rWa=z6((b,c,d,e)=>{const f=[];e=this.zWa(b,c,d,e);c=(l,m)=>(l=__c.fj(b.cells,m,l))&&__c.jta(l);for(const {xa:l,column:m,textAlign:n,cRa:p}of e){var g=p.width+("center"===n?0:this.cQa),h=void 0;switch(n){case "start":case "justify":e=b.qa(m);h=e+g;break;case "center":h=b.qa(m)+m.width/2;e=h-g/2;h+=g/2;break;case "end":h=b.qa(m)+m.width;e=h-g;break;default:throw new D(n);}for(g=d.indexOf(m)-1;0<=g;g--){var k=d[g];if(k!==m&&!c(l,k)||!PBb(e,
h,b.qa(k)+k.width))break;f.push({xa:l,column:k,edge:"inlineEnd"})}for(g=d.indexOf(m)+1;g<d.length;g++){k=d[g];if(k!==m&&!c(l,k)||!PBb(e,h,b.qa(k)))break;f.push({xa:l,column:k,edge:"inlineStart"})}}return f},{equals:m6.structural});this.zWa=z6((b,c,d,e)=>{const f=[];for(const h of d)for(const k of c){var g;d=b.layout.cells.get(k,h);if(!d||!d.ref.content.ref||d.span.Oc!==d.span.re||d.span.Kc!==d.span.Vd)continue;const {Qi:l,textAlign:m}=Hd(__c.Sd,b.layout.attrs.get(Td({Qi:void 0,textAlign:void 0}),
k,h)||{}),n=this.GX.oy(b,k,h);d=__c.zI(m,d.ref.content.ref.type,null===(g=d.ref.Ba.ref)||void 0===g?void 0:g.type,n?()=>n.$u.type:void 0);const p=e(k,h);"overflow"===l&&p&&d&&f.push({xa:k,column:h,textAlign:d,cRa:p})}return f},{equals:m6.structural})}};var f6=(a,b)=>`${a.column.id}-${a.boundary}:${b.xa.id}-${b.boundary}`,ECb=class{constructor(){this.jK=DCb;this.KQa=z6(a=>{const b=new Map;for(const {column:c,xa:d,edge:e}of a){switch(e){case "blockStart":a={ra:!0};break;case "blockEnd":a={Fa:!0};break;case "inlineStart":a={qa:!0};break;case "inlineEnd":a={Ja:!0};break;default:throw new D(e);}const f=`${c.id}:${d.id}`;b.set(f,{...b.get(f),...a})}return b});this.IWa=z6(a=>{const b=new Map;let c=0;a.rows.forEach(d=>{const e=c,f=e+d.height;b.set(d,{start:e,
end:f});c=f});return b});this.gWa=z6(a=>{const b=new Map;var c="rtl"===a.direction;const d=c?-1:1;let e=0;c&&(c=a.cols.last(),e=null!=c?a.qa(c)+c.width:0);a.cols.forEach(f=>{const g=e,h=g+f.width*d;b.set(f,{start:g,end:h});e=h});return b})}},FCb=class{constructor(){this.m5a=z6((a,b)=>{const c=new Map;for(const d of a.rows)for(const e of a.cols){const f=`${e.id}:${d.id}`,g=aCb(a,{column:e,xa:d},b);g&&c.set(f,g)}return c},{equals:m6.identity});this.uRa=z6(a=>{const b=new Map;for(const d of a.cols)for(const e of a.rows){var c=
g6(this,a,d,e);if(!c)continue;const f=c.qa,g=c.Ja,h=c.ra;c=c.Fa;f&&b.set(f.color,(b.get(f.color)||0)+1);h&&b.set(h.color,(b.get(h.color)||0)+1);g&&d===a.cols.last()&&b.set(g.color,(b.get(g.color)||0)+1);c&&e===a.rows.last()&&b.set(c.color,(b.get(c.color)||0)+1)}return b},{equals:m6.identity})}},DCb=new FCb,VBb=new ECb;var E6=class a extends s6{static A(b){P(b,{cna:e6({equals:m6.shallow}),dna:e6({equals:m6.shallow}),jza:e6({equals:m6.structural})})}componentDidMount(){const b=B(this.ref.current);rc(this,w6(()=>{var c=this.props.scaleFactor;const d=this.props.sheet;var e;c=null!==(e=null===c||void 0===c?void 0:c.get())&&void 0!==e?e:1;e=d.height;b.style.width=`${d.width*c}px`;b.style.height=`${e*c}px`}))}get cna(){const b=this.props.sheet;return[...this.props.E9a].sort((c,d)=>b.cols.Ol(c,d))}get dna(){const b=this.props.sheet;
return[...this.props.Uw].sort((c,d)=>b.rows.Ol(c,d))}get jza(){return this.props.Xga.rWa(this.props.sheet,this.dna,this.cna,this.props.eU)}render(){var b=this.props.sheet;const c=WBb(b,this.dna,this.cna,this.jza),d=b.width,e=b.height;b="rtl"===b.direction;return V5("svg",{ref:this.ref,role:"presentation",className:X5("c6a1eQ",{H_CtIQ:!b,_8_56PQ:b}),viewBox:`0 0 ${d} ${e}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:f,color:g,weight:h,Si:k,Ti:l})=>V5("path",{stroke:g,strokeDasharray:k,
strokeDashoffset:l,strokeWidth:h,d:f.map(({p1:m,p2:n})=>`M ${m.x} ${m.y} L ${n.x} ${n.y}`).join(" ")},`${g}-${h}-${k}-${l}`))})}constructor(...b){super(...b);a.A(this);this.ref=jCb()}};E6=x6([Gc],E6);var G6=class a extends s6{static A(b){P(b,{f2:e6,KJa:e6})}render(){var b;const c=this.props.PVa;return p6("div",{ref:this.QGa,className:X5("ZTz_iA","ltr"===this.props.sheet.direction?"TA4X7w":"WvuqMw"),children:[(null===c||void 0===c?void 0:c.pPa)&&V5(F6,{...this.props,range:c.pPa.range,Xs:!0,Ys:!0,className:"_0C8M3w",m0:this.f2}),(null===c||void 0===c?void 0:c.s9a)&&V5(F6,{...this.props,range:c.s9a.range,Xs:!1,Ys:!0,className:"_7n44yg",m0:this.f2}),(null===c||void 0===c?void 0:c.wXa)&&V5(F6,{...this.props,
range:c.wXa.range,Xs:!0,Ys:!1,className:"fF5r6w",m0:this.f2}),V5(F6,{...this.props,range:null===c||void 0===c?void 0:null===(b=c.Q8a)||void 0===b?void 0:b.range,Xs:!1,Ys:!1,className:"llILYw",m0:this.KJa})]})}componentDidMount(){const b=w6(()=>{var c=this.props,d=c.scaleFactor;c=c.sheet;const e=this.QGa.current;e&&(d=d?d.get():1,e.style.width=`${c.width*d}px`,e.style.height=`${c.height*d}px`)});rc(this,[b])}get f2(){return{type:"excluded"}}get KJa(){return{type:"hidden",TL:this.OPa}}constructor(...b){super(...b);
a.A(this);this.QGa=vt();this.OPa=(c,d)=>{var e;const f=this.props.sheet;var g=this.props.PVa;g=null===g||void 0===g?void 0:null===(e=g.Q8a)||void 0===e?void 0:e.range;return null==g?!0:0<=f.cols.Ol(c,g.Kc)&&0>=f.cols.Ol(c,g.Vd)&&0<=f.rows.Ol(d,g.Oc)&&0>=f.rows.Ol(d,g.re)}}};G6=x6([Gc],G6);
var F6=class a extends s6{static A(b){P(b,{OGa:e6})}get OGa(){const b=this.props.viewport,c=this.props.Xs,d=this.props.Ys;return null==b||!c&&!d?b:e6(()=>{const e=__c.ms(b.get());return __c.es({top:d?0:e.top,left:c?0:e.left,width:e.width,height:e.height})})}render(){const b=this.props.sheet,c=this.props.range,d=this.props.m0,e=this.props.IG,f=this.props.oR,g=this.props.Xs,h=this.props.Ys,k="ltr"===b.direction?"TA4X7w":"WvuqMw";return V5("div",{ref:this.vka,className:X5("i0YQww",this.props.className),
children:p6("div",{ref:this.FDa,children:[p6("div",{ref:this.EDa,className:"vUKoKg",children:[V5(H6,{...this.props,viewport:this.OGa,bounds:"hidden"===(null===d||void 0===d?void 0:d.type)?void 0:c,TL:"hidden"===(null===d||void 0===d?void 0:d.type)?d.TL:void 0}),V5("div",{className:X5("DC3n2A",k),children:f&&V5(f,{range:c})})]}),V5("div",{className:X5("DC3n2A",k),children:e&&V5(e,{sheet:b,range:c,Xs:g,Ys:h})})]})})}componentDidMount(){const b=w6(()=>{var h=this.props,k=h.scaleFactor,l=h.sheet;const m=
h.range;var n=this.vka.current;const p=this.EDa.current;h=this.FDa.current;k=k?k.get():1;const q=m?l.qa(m.Vd)+m.Vd.width-l.qa(m.Kc):l.width,r=m?l.ra(m.re)+m.re.height-l.ra(m.Oc):l.height;n&&(n.style.width=`${q*k}px`,n.style.height=`${r*k}px`);p&&(p.style.width=`${q*k}px`,p.style.height=`${r*k}px`);h&&(n="rtl"===l.direction,n=m?l.qa(m.Kc)*k*(n?1:-1):0,l=m?-l.ra(m.Oc)*k:0,h.style.transform=`translate(${n}px, ${l}px)`)}),c=this.props.sheet;var d=this.props.Y2;const e=this.props.Xs,f=this.props.Ys,g=
null===d||void 0===d?void 0:d(c,e,f);d=w6(()=>{const h=this.vka.current;if(null!=h){var k=e||f?"sticky":"relative",l=f?"0px":"unset",m=e?"0px":"unset",n=e?"0px":"unset",p="rtl"===c.direction;if(null==g)h.style.position=k,h.style.top=l,h.style.left=p?"unset":m,h.style.right=p?n:"unset";else{const x=g.get();var q;h.style.position=null!==(q=x.position)&&void 0!==q?q:k;var r;h.style.top=null!==(r=x.top)&&void 0!==r?r:l;var t;h.style.left=p?"unset":null!==(t=x.left)&&void 0!==t?t:m;var u;h.style.right=
p?null!==(u=x.right)&&void 0!==u?u:n:"unset";var w;h.style.transform=null!==(w=x.transform)&&void 0!==w?w:"unset"}}});rc(this,[b,d])}constructor(...b){super(...b);a.A(this);this.vka=vt();this.FDa=vt();this.EDa=vt()}};F6=x6([Gc],F6);
var GCb=class{constructor(){this.xS=new Map;this.X9a=(a,b,c,d)=>{const e=new GCb;for(const [f,g]of this.xS)c.has(g.xa)&&e.xS.set(f,g);c=`${b.id}:${a.id}`;d?e.xS.set(c,{width:d.width,height:d.height,xa:a,column:b}):e.xS.delete(c);return e};this.eU=(a,b)=>this.xS.get(`${b.id}:${a.id}`)}},H6=class a extends s6{static A(b){P(b,{WK:u6.shallow,Do:e6,bounds:e6,Uw:e6({equals:m6.shallow}),dpa:e6({equals:m6.shallow}),bsa:v6,$0:v6.bound})}get Do(){var b;const c=null===(b=this.props.ov)||void 0===b?void 0:b.get();
if(null!=c&&0!==c.length)return new __c.pE(c)}render(){var b;return p6("div",{ref:mCb(this.Td,null===(b=this.Do)||void 0===b?void 0:b.Wf),children:[V5("div",{ref:this.bta,className:"_5YlOqQ"}),V5("div",{ref:this.kta,className:"_XCmKw"}),this.WK.map(c=>c.N3a),V5(this.R$,{eU:this.state.eU})]})}componentDidMount(){const b=l6(()=>[this.dpa,this.Uw],([e,f])=>this.bsa(e,f),{fireImmediately:!0}),c=w6(()=>{var e=this.props,f=e.scaleFactor;e=e.sheet;const g=this.Td.current;g&&(f=f?f.get():1,g.style.width=
`${e.width*f}px`,g.style.height=`${e.height*f}px`)}),d=this.WK.map(e=>cCb(e));rc(this,[c,b,...d])}get bounds(){const b=this.props.sheet,c=this.props.bounds;var d,e,f,g;return{Kc:null!==(d=null===c||void 0===c?void 0:c.Kc)&&void 0!==d?d:b.cols.first(),Vd:null!==(e=null===c||void 0===c?void 0:c.Vd)&&void 0!==e?e:b.cols.last(),Oc:null!==(f=null===c||void 0===c?void 0:c.Oc)&&void 0!==f?f:b.rows.first(),re:null!==(g=null===c||void 0===c?void 0:c.re)&&void 0!==g?g:b.rows.last()}}get Uw(){const b=this.bounds,
c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=500*e,g=null===d||void 0===d?void 0:d.get();d=g?g.tl.y-f:b.Oc?c.ra(b.Oc):0;f=g?g.br.y+f:b.re?c.ra(b.re)+b.re.height:0;g=new Map;for(let h=b.Oc;null!=h&&null!=b.re&&0>=c.rows.Ol(h,b.re);h=c.rows.next(h)){const k=c.ra(h);if(!(k+h.height<d)){if(k>f)break;g.set(h,k*e)}}return g}get dpa(){const b=this.bounds,c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=100*e,g=null===d||void 0===
d?void 0:d.get();d=g?g.tl.x-f:b.Kc?c.qa(b.Kc):0;f=g?g.br.x+f:b.Vd?c.qa(b.Vd)+b.Vd.width:0;g=new Map;for(let h=b.Kc;null!=h&&null!=b.Vd&&0>=c.cols.Ol(h,b.Vd);h=c.cols.next(h)){const k=c.qa(h);if(!(k+h.width<d)){if(k>f)break;g.set(h,k*e)}}return g}bsa(b,c){const d=B(this.bta.current),e=B(this.kta.current),f=[],g=new Map;for(const h of this.GKa)c.has(h.xa)?g.set(h.xa,h):f.push(h);for(const [h,k]of c)c=g.get(h)||f.pop(),c||(c=new HCb(this.$0,h),d.appendChild(c.j0),e.appendChild(c.l0),this.GKa.push(c)),
c.update(k,h,b);for(const h of f)h.hide()}$0(b,c){const d=this.props.kda,e=this.props.sheet,f=this.props.TL;b=new ICb(this.props.CG,this.props.Rj,d(b,c),e,b,c,f,this.$V);rc(this,cCb(b));this.WK.push(b);return b}constructor(b){super(b);a.A(this);this.Td=vt();this.bta=vt();this.kta=vt();this.GKa=[];this.WK=[];this.R$=Z5(c=>{const d=[...this.Uw.keys()],e=[...this.dpa.keys()];return V5(this.props.cNa,{Uw:d,E9a:e,eU:c.eU})});this.$V=(c,d,e)=>{this.setState(f=>{const g=e();return f.X9a(d,c,this.Uw,g)})};
this.state=new GCb}};H6=x6([Gc],H6);
var HCb=class{static A(a){P(a,{update:v6})}update(a,b,c){[this.j0,this.l0].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.xa=b;for(const [d]of c)c=this.WK.get(d),c||(c=this.$0(d,b),this.WK.set(d,c),this.j0.appendChild(c.pca),this.l0.appendChild(c.YL)),c.update(b)}hide(){[this.j0,this.l0].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){HCb.A(this);this.$0=a;this.xa=b;this.j0=document.createElement("div");this.l0=document.createElement("div");
this.WK=new Map}},ICb=class{static A(a){P(a,{R0:u6.ref,xa:u6.ref,Ca:e6,attrs:e6,$U:e6,renderer:e6,update:v6})}get N3a(){return this.R0}get Ca(){return __c.fj(this.sheet.cells,this.col,this.xa)}get attrs(){return this.sheet.layout.attrs.get(Td({Qi:0,textAlign:0,direction:0}),this.xa,this.col)||{}}get $U(){return this.TL?!this.TL(this.col,this.xa):!1}get renderer(){const a=this.Ca;if(a&&(a.content||a.Ba))return this.CG({context:{xa:this.xa,col:this.col,sheet:this.sheet,attrs:this.attrs},TO:this.$V,
Rj:this.Rj})}update(a){this.xa=a;this.gY.xa=a}constructor(a,b,c,d,e,f,g,h){ICb.A(this);var k,l,m,n,p,q;this.CG=a;this.gY=c;this.sheet=d;this.col=e;this.TL=g;this.pca=document.createElement("div");this.YL=document.createElement("div");this.ED=document.createElement("div");this.FA=document.createElement("div");this.IW=document.createElement("div");this.S_a=()=>{if(this.renderer){var r="react"===this.renderer.type?this.IW:this.FA;if(0!==r.childNodes.length&&(r=r.childNodes[0],r instanceof HTMLElement))return{width:r.clientWidth,
height:r.clientHeight}}};this.xa=f;this.pca.className="_2JFriw";this.YL.className="imy9ug";this.ED.className=X5("pDMp7w",{_0yZ6Qg:"text3"!==(null===(l=this.Ca)||void 0===l?void 0:null===(k=l.content)||void 0===k?void 0:k.type),qhF5uA:"text3"!==(null===(n=this.Ca)||void 0===n?void 0:null===(m=n.content)||void 0===m?void 0:m.type)&&"text2"!==(null===(q=this.Ca)||void 0===q?void 0:null===(p=q.content)||void 0===p?void 0:p.type)});this.FA.className="_30B9pw";this.ED.appendChild(this.FA);this.YL.appendChild(this.ED);
this.IW.className="G7zH2w";this.$V=()=>{h(this.col,this.xa,this.S_a)};this.Rj=r=>V5(b,{...r,TO:this.$V})}};var n6=class extends s6{render(){const a=this.props.sheet,b=this.props.ov,c=this.props.Y2,d=this.props.CG,e=this.props.ad,f=this.props.Rj,g=this.props.viewport,h=this.props.IG,k=this.props.oR;return V5("div",{className:X5("SNkrHw","ltr"===a.direction?"TA4X7w":"WvuqMw"),...e,children:V5(G6,{CG:d,Rj:f,cNa:this.R$,kda:this.kda,sheet:a,ov:b,Y2:c,scaleFactor:this.scaleFactor,viewport:g,IG:h,oR:k})})}get scaleFactor(){return this.props.scaleFactor?this.props.scaleFactor:e6(()=>1)}constructor(...a){super(...a);
this.R$=Z5(b=>V5(E6,{...b,sheet:this.props.sheet,scaleFactor:this.scaleFactor,Xga:this.props.Xga}));this.kda=(b,c)=>new __c.qta(this.props.zw,this.props.sheet,b,c,this.scaleFactor,this.jy,this.wy);this.jy=(b,c)=>{var d,e;return null===(d=(e=this.props).jy)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)};this.wy=(b,c)=>{var d,e;return null===(d=(e=this.props).wy)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)}}};n6=x6([Gc],n6);__c.vta={qYa:function(a){const b=a.Sl,c=a.Gd,d=a.zc,e=a.hl,f=a.GX,g=a.zw,h=a.BR;zBb({yw:a.yw,hh:a.hh,H7a:a.$J});const k=eCb({CG:h,GX:f,zw:g});b.laa=OBb({uq:k});c.S$=GBb({uq:k});({gNa:a}=LBb({uq:k,Rd:e(),NGa:new xCb}));d.Wn.kaa=a;const {mLa:l,nLa:m,lLa:n}=FBb();return{yqa:Z5(p=>V5(oCb,{...p,uq:k,fNa:l,hNa:m,dNa:n,Rj:pCb}))}}};
}).call(self, self._fe4d99ebe0d2d259646a80d250150d47);}

}])
//# sourceMappingURL=sourcemaps/55ccd931a2007c8a.js.map